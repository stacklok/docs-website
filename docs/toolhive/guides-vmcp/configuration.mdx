---
title: VirtualMCPServer configuration reference
description: Complete reference for VirtualMCPServer CRD configuration.
---

This reference documents all configuration options for the VirtualMCPServer
custom resource.

## Spec fields

### spec.groupRef (required)

References the MCPGroup containing backend MCPServers to aggregate.

```yaml
spec:
  groupRef:
    name: engineering-tools
```

The MCPGroup must exist in the same namespace and be in a Ready state before the
VirtualMCPServer can start.

### spec.incomingAuth

Configures authentication for clients connecting to Virtual MCP. See
[Authentication](./authentication.mdx) for detailed configuration.

{/* TODO: Add incomingAuth configuration details */}

**Supported types:**

| Type         | Description                                   |
| ------------ | --------------------------------------------- |
| `anonymous`  | No authentication required (development only) |
| `oidc`       | OpenID Connect authentication                 |
| `kubernetes` | Kubernetes service account tokens             |

### spec.outgoingAuth

Configures authentication from Virtual MCP to backend APIs.

{/* TODO: Add outgoingAuth configuration details */}

**Source options:**

| Source       | Description                                                     |
| ------------ | --------------------------------------------------------------- |
| `discovered` | Auto-discover from backend MCPServer.spec.externalAuthConfigRef |
| `inline`     | Explicit per-backend configuration                              |
| `mixed`      | Discover most, override specific backends                       |

### spec.aggregation

Controls how tools from multiple backends are aggregated.

{/* TODO: Add aggregation configuration details */}

See [Tool aggregation](./tool-aggregation.mdx) for detailed configuration.

### spec.tokenCache

Configures caching for exchanged tokens.

{/* TODO: Add tokenCache configuration details */}

**Providers:**

| Provider | Description                                  |
| -------- | -------------------------------------------- |
| `memory` | In-memory cache (default)                    |
| `redis`  | Distributed Redis cache (for HA deployments) |

### spec.operational

Configures timeouts and failure handling.

{/* TODO: Add operational configuration details */}

### spec.compositeTools

Defines multi-step workflows that span multiple backends.

{/* TODO: Add compositeTools configuration details */}

See [Composite tools](./composite-tools.mdx) for detailed configuration.

### spec.serviceType

Kubernetes service type for the Virtual MCP endpoint.

```yaml
spec:
  serviceType: ClusterIP # ClusterIP | NodePort | LoadBalancer
```

### spec.podTemplateSpec

Custom pod specification for advanced configuration. The container name must be
`vmcp`.

{/* TODO: Add podTemplateSpec example */}

## Status fields

### status.phase

Current lifecycle state:

| Phase      | Description                           |
| ---------- | ------------------------------------- |
| `Pending`  | Waiting for dependencies              |
| `Ready`    | Fully operational                     |
| `Degraded` | Running but some backends unavailable |
| `Failed`   | Configuration or critical error       |

### status.conditions

Detailed condition information:

- `Ready`: Whether VirtualMCPServer is ready to serve requests
- `GroupRefValidated`: Whether MCPGroup reference is valid
- `AuthConfigured`: Whether authentication is configured
- `BackendsDiscovered`: Whether backends were discovered

### status.url

Service URL for client connections:

```text
http://vmcp-{name}.{namespace}.svc.cluster.local:4483
```

### status.discoveredBackends

Array of discovered backend information including name, status, auth
configuration, and last health check timestamp.

## Example configurations

### Minimal configuration

```yaml
apiVersion: toolhive.stacklok.dev/v1alpha1
kind: VirtualMCPServer
metadata:
  name: my-vmcp
spec:
  groupRef:
    name: my-group
```

### With OIDC authentication

{/* TODO: Add OIDC example */}

### Production configuration

{/* TODO: Add production example */}

## Related information

- [Deploy Virtual MCP Server](./quickstart.mdx)
- [Tool aggregation](./tool-aggregation.mdx)
- [Authentication](./authentication.mdx)
